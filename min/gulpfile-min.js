var gulp=require("gulp"),plumber=require("gulp-plumber"),rename=require("gulp-rename"),autoprefixer=require("gulp-autoprefixer"),babel=require("gulp-babel"),concat=require("gulp-concat"),uglify=require("gulp-uglify"),imagemin=require("gulp-imagemin"),cache=require("gulp-cache"),minifycss=require("gulp-minify-css"),sass=require("gulp-sass"),browserSync=require("browser-sync");gulp.task("browser-sync",function(){browserSync({server:{baseDir:"./"}})}),gulp.task("bs-reload",function(){browserSync.reload()}),gulp.task("images",function(){gulp.src("app/images/**/*").pipe(cache(imagemin({optimizationLevel:3,progressive:!0,interlaced:!0}))).pipe(gulp.dest("build/images/"))}),gulp.task("styles",function(){gulp.src(["app/styles/**/*.scss"]).pipe(plumber({errorHandler:function(e){console.log(e.message),this.emit("end")}})).pipe(sass()).pipe(autoprefixer("last 2 versions")).pipe(gulp.dest("build/styles/")).pipe(rename({suffix:".min"})).pipe(minifycss()).pipe(gulp.dest("build/styles/")).pipe(browserSync.reload({stream:!0}))}),gulp.task("scripts",function(){return gulp.src("app/scripts/**/*.js").pipe(plumber({errorHandler:function(e){console.log(e.message),this.emit("end")}})).pipe(concat("main.js")).pipe(babel()).pipe(gulp.dest("build/scripts/")).pipe(rename({suffix:".min"})).pipe(uglify()).pipe(gulp.dest("build/scripts/")).pipe(browserSync.reload({stream:!0}))}),gulp.task("default",["browser-sync"],function(){gulp.watch("app/styles/**/*.scss",["styles"]),gulp.watch("app/scripts/**/*.js",["scripts"]),gulp.watch("*.html",["bs-reload"])});